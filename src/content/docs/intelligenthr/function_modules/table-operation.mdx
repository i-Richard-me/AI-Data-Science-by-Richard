---
title: "🧮 表格处理助手"
description: ""
---

## 功能演示

<iframe src="//player.bilibili.com/player.html?isOutside=true&aid=113029446435702&bvid=BV1FJsEegE1R&cid=500001663396506&p=1&high_quality=1&danmaku=0" width="100%" style="height: 560px;" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe>


## 1. 功能概述

表格处理助手是一个基于人工智能的数据处理工具，专门设计用于简化和加速表格数据的操作和分析过程。本工具结合了自然语言处理和数据处理技术，提供了以下核心功能：

- 智能对话操作：通过自然语言交互理解用户意图，自动选择合适的数据处理工具。
- 多样化数据操作：包括表格合并、数据转置、筛选排序、数据集比较等多种数据处理功能。
- 实时结果展示：即时显示操作结果，便于用户验证和调整。

特别适用于数据分析师和其他需要频繁处理表格数据的用户。它能显著提高数据处理效率，减少手动操作错误，并为用户提供更直观的数据处理体验。

## 2. 使用步骤和功能说明

### 2.1 数据上传

1. 文件选择
    - 支持上传多个CSV格式的文件。
    - 在界面上点击"选择CSV文件（可多选）"按钮，或直接将文件拖拽到指定区域。

2. 数据加载
    - 系统自动读取并加载上传的CSV文件。
    - 每个文件被加载为一个独立的数据集，使用文件名（不包括扩展名）作为数据集名称。
    - 加载成功后，系统会显示成功消息，如"成功加载数据集: [数据集名称]"。

3. 数据集信息展示
    - 在"已加载的数据集"部分，系统列出所有已加载的数据集。
    - 每个数据集信息以可展开的形式显示，包含：
        - 数据集名称
        - 数据形状（行数和列数）
        - 列名及其对应的数据类型

### 2.2 数据操作

1. 发起操作请求
    - 在"数据集操作"部分的输入框中，输入自然语言形式的操作需求。
    - 示例：
        - "合并员工信息表和工资表，使用员工ID作为关键字"
        - "将考勤数据从宽格式转为长格式，每一天作为单独的一行"
        - "比较2022年和2023年的员工名单，找出新入职和离职的员工"

2. AI助手处理
    - 系统分析用户输入，理解操作意图。
    - 根据理解的意图，选择合适的数据处理工具。
    - 如果需要更多信息，助手会提出跟进问题。

3. 执行操作
    - 系统使用选定的工具执行数据操作。
    - 操作过程中显示"思考中..."的提示。

4. 结果展示
    - 操作完成后，系统在"操作结果"部分显示处理后的数据。
    - 如果结果包含多个数据框，会使用选项卡形式分别展示。

5. 结果导出
    - 用户可以点击"下载结果Excel"按钮，将处理结果以Excel格式下载。

### 2.3 主要数据处理功能

1. 表格合并（merge_dataframes）
    - 功能：合并两个数据表，基于指定的列进行连接操作。
    - 参数：
        - 左侧数据表和右侧数据表
        - 合并方式（内连接、外连接、左连接、右连接）
        - 用于连接的列名
        - 可选择包含在结果中的列
    - 使用场景：整合来自不同来源的相关数据，如合并员工基本信息和绩效数据。

2. 宽格式转长格式（reshape_wide_to_long）
    - 功能：将宽格式的数据表重塑为长格式。
    - 参数：
        - 输入的宽格式数据表
        - 需要被压缩成长格式的列名列表
        - 新列名，用于存储原来的列名和值
    - 使用场景：转换多时间点的数据为便于分析的格式，如将多月考勤数据转为单列。

3. 长格式转宽格式（reshape_long_to_wide）
    - 功能：将长格式的数据表重塑为宽格式。
    - 参数：
        - 输入的长格式数据表
        - 包含将成为新列名的值的列名
        - 包含将成为新列值的列名
        - 聚合函数（处理重复值）
    - 使用场景：创建交叉表或透视表，如将每日考勤数据转为每人一行、每日一列的格式。

4. 数据集比较（compare_dataframes）
    - 功能：比较两个数据表，找出它们之间的差异。
    - 参数：
        - 两个要比较的数据表
        - 用于比较的关键列名
    - 使用场景：对比不同时间点的员工名单，识别新入职和离职员工。

## 3. 使用技巧

1. 清晰表述需求
    - 在输入操作需求时，尽量提供完整的信息，包括涉及的数据集名称、操作类型和关键参数。
    - 示例："请合并'员工信息'和'工资表'两个数据集，使用'员工ID'列作为关键字，采用左连接方式"

2. 分步骤操作
    - 对于复杂的数据处理需求，考虑将其拆分为多个简单步骤。
    - 每完成一步操作后，检查中间结果，确保符合预期。

## 4. 性能和限制

1. 数据规模
    - 推荐处理的数据量：单个CSV文件不超过100MB。
    - 最大支持同时加载的数据集数量：10个。

2. 处理时间
    - 文件上传和加载时间与文件大小和复杂度成正比。
    - 大多数操作（如合并、重塑）通常在几秒内完成。

3. 内存使用
    - 系统会将所有加载的数据集保存在内存中，大量大型数据集可能导致内存使用增加。

4. 文件格式
    - 目前仅支持CSV格式的文件上传。
    - 导出结果仅支持Excel格式。

5. 并发操作
    - 系统一次只能处理一个用户的一个请求。

## 5. 最佳实践案例

1. 员工数据整合与分析

   场景：HR部门需要整合来自不同系统的员工信息，并进行全面分析。

   步骤：
      - 上传"员工基本信息.csv"、"绩效评估.csv"
      - 输入："我想将绩效结果匹配到'员工基本信息'表，使用员工ID作为关键字"

2. 年度员工流动分析

   场景：比较两年的员工名单，识别新入职和离职员工。

   步骤：
      - 上传"2022年员工名单.csv"和"2023年员工名单.csv"
      - 输入："比较附件中两年的员工名单变化"

## 6. 常见问题解答（FAQ）

1. Q: 可以保存中间处理结果吗？

   A: 系统目前不支持自动保存中间结果。建议在每个关键步骤后使用"下载结果Excel"按钮保存当前结果。这样不仅可以保留中间步骤的数据，还能在必要时回退操作。

2. Q: 如何处理日期格式的数据？

   A: 系统会尝试自动识别常见的日期格式。如果遇到日期处理问题，可以尝试以下方法：
    - 确保CSV文件中的日期格式一致。

3. Q: 能否处理包含缺失值的数据？

   A: 系统能够处理包含缺失值的数据，但建议在进行关键操作（如合并或比较）之前，先处理缺失值。

4. Q: 如何处理大文件导致的性能问题？

   A: 对于较大的文件，可以采取以下策略：
    - 在上传前对数据进行初步筛选，只包含必要的列和行。

5. Q: 系统支持自定义函数或复杂的数据转换吗？

   A: 目前系统主要支持预设的数据处理功能。对于复杂的自定义需求，可以：
    - 尝试将复杂操作分解为多个基本步骤。
    - 使用系统提供的功能创建中间结果，然后在外部工具中进行进一步处理。

6. Q: 系统会保存我的数据吗？数据安全如何保证？

   A: 系统不会永久保存上传的数据或处理结果。所有数据仅在当前会话中保存在内存中，会话结束后自动清除。